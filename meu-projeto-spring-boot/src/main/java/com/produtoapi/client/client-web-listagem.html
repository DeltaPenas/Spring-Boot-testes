<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Produtos</title>
</head>
<body>
<h2>Lista de  e Clientes - HTML/JavaScript</h2>


<table id="produtosTable" border="1">
    <thead>
    <tr>
        <th>ID</th>
        <th>Nome</th>
        <th>Pre√ßo</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<!-- Mensagem de erro -->
<div id="erroMensagem" style="color: red; display: none;">
    Erro ao buscar produtos. Por favor, tente novamente mais tarde.
</div>

<!-- Total de produtos -->
<div id="totalProdutos">Total de Produtos: 0</div>



<script>
    function listarProdutos() {
        fetch('http://localhost:8080/produtos')
            .then(response => {
                if (!response.ok) {


                    throw new Error('Erro na rede: ' + response.status);
                }

                return response.json();
            })
            .then(data => {

                const tableBody = document.getElementById('produtosTable').getElementsByTagName('tbody')[0];
                let totalProdutos = 0;

                data.forEach(produto => {
                    const row = tableBody.insertRow();
                    const cellId = row.insertCell(0);
                    const cellNome = row.insertCell(1);
                    const cellValor = row.insertCell(2);

                    cellId.textContent = produto.id;
                    cellNome.textContent = produto.nome;
                    cellValor.textContent = produto.valor;
                    totalProdutos++;
                });
                // Exibe o total de produtos
                document.getElementById('totalProdutos').textContent = 'Total de Produtos: ' + totalProdutos;
            })
            .catch(error => {
                console.error('Erro ao buscar produtos:', error); // Exibe o erro no console
                // Exibe a mensagem de erro
                document.getElementById('erroMensagem').style.display = 'block'; // Exibe a mensagem de erro
            });
    }

    document.addEventListener('DOMContentLoaded', listarProdutos);
</script>
</body>
</html>
